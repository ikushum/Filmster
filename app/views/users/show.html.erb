<%= image_tag @user.avatar, class: 'prof-pic-lg' %>
<h1 class="text-center"><%= @user.username %></h1>
<p class="text-center lead"><%= @user.introduction %></p>

<ul class="user-stats">
  <li>
    <div class="number-label">Reviews</div>
    <div class="number-value"><%= @user.reviews.count %></div>
  </li> 
  
  <li id="user-followers">
    <div class="number-label">Followers</div>
    <div class="number-value"><%= @user.followed_relationships.count %></div>
  </li> 
  
   <li id="user-following">
    <div class="number-label">Following</div>
    <div class="number-value"><%= @user.following_relationships.count %></div>
  </li> 
  
</ul>

<% if current_user.following?(@user) %>
    <%= link_to 'Unfollow', user_relationship_path(@user.id), method: 'delete', class: 'btn btn-success btn-user-action center-block',style: 'width:200px', remote: true %>
<% else %>
    <%= link_to 'Follow', user_relationships_path(@user.id), method: 'post', class: 'btn btn-success btn-user-action center-block', style: 'width:200px' %>
<% end %>

<div id="movie">
    <script type="text/javascript">
        $.ajax({
          dataType: "json",
          url: "<%= user_path(@user.id) %>.json",
        })
        .done(function(data){
            console.log(data)
            let container = $("#movie")
            let htmlString = "";
            container.empty();
            data["reviews"].forEach(function(review){
                    htmlString += `<div class="grid-item--width2">
                                     <a href="/movies/${review["movie"].id}"> <img src=${review["movie"].poster == "N/A" ? "http://www.reelviews.net/resources/img/default_poster.jpg" : review["movie"].poster} class="grid-item" /></a>
                                     <p class="grid-item">${review["movie"].title}</p>
                                     <p class="grid-item">${review["comment"]}</p>
                                    </div>`;
            });
            container.append(htmlString);
        });
    </script>
</div>